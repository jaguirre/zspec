;This function converts frequency ID to frequency in GHz.  The conversion is
;based on a 3rd order polynomial fit to the bandcenters measured using
;the Colorado FTS in March 2006.
;
; UPDATES - BN 01.03.07 - Made a lookup table based on Randol's FTS
;                         bandcenter extractions from Nov 2006 Data
;                         Corrected swap of freqid 49 & 51
;                         If no arguments given, then returns all freqs
;
;           BN 07.23.09 - Added 2nd order polynomial shift based on
;                         fits to IRC+10216 data.  Added NO_SHIFT
;                         keyword in case shift is not desired.


FUNCTION freqid2freq, freqid, NO_SHIFT = NO_SHIFT

  gaussmean = [$
              185.506, 185.950, 186.395, 186.900, 187.362, 187.847, 188.277, $
              188.694, 189.149, 189.642, 190.085, 190.564, 191.055, 191.507, $
              192.033, 192.478, 192.914, 193.361, 193.910, 194.492, 195.086, $
              195.588, 196.065, 196.613, 197.091, 197.653, 198.155, 198.680, $
              199.162, 199.802, 200.276, 200.774, 201.325, 201.853, 202.418, $
              202.951, 203.492, 204.058, 204.592, 205.233, 205.964, 206.528, $
              207.115, 207.638, 208.244, 208.789, 209.389, 209.944, 210.580, $
              211.224, 211.749, 212.389, 212.986, 213.611, 214.218, 214.823, $
              215.453, 216.084, 216.711, 217.407, 218.152, 218.844, 219.493, $
              220.109, 220.745, 221.401, 222.013, 222.750, 223.374, 224.030, $
              224.678, 225.350, 226.019, 226.731, 227.420, 228.116, 228.777, $
              229.499, 230.184, 230.954, 231.893, 232.608, 233.365, 234.068, $
              234.812, 235.542, 236.309, 237.035, 237.815, 238.536, 239.315, $
              240.102, 240.911, 241.703, 242.461, 243.251, 244.067, 244.874, $
              245.683, 246.541, 247.576, 248.439, 249.236, 250.037, 250.865, $
              251.682, 252.538, 253.360, 254.195, 255.062, 255.930, 256.818, $
              257.674, 258.520, 259.399, 260.261, 261.231, 262.179, 263.031, $
              264.045, 265.229, 266.199, 267.149, 268.123, 269.051, 270.017, $
              270.996, 271.926, 272.943, 273.941, 274.972, 276.021, 277.010, $
              278.038, 279.083, 280.126, 281.192, 282.216, 283.339, 284.539, $
              285.880, 286.978, 288.109, 289.125, 290.147, 291.365, 292.356, $
              293.424, 294.633, 295.650, 296.783, 297.888, 299.000, 300.274, $
              301.340, 302.646, 303.687, 304.866, 306.082, 307.404]

  IF ~KEYWORD_SET(NO_SHIFT) THEN BEGIN
     polycof = [-0.45522401,      0.59646798,     -0.30161380]
     gm_norm = (gaussmean - 180.D)/(320.D - 180.D)
     gaussmean += POLY(gm_norm, polycof)
  ENDIF

  CASE N_PARAMS() OF
     0: RETURN, gaussmean
     1: RETURN, gaussmean[freqid]
     ELSE: MESSAGE, 'I am confused - what frequencies did you want?'
  ENDCASE
  
END
